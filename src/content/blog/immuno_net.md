---
title: "模拟免疫的深度神经网络"
description: ""
pubDate: 2026-01-05 14:47
tags:
  - "神经网络"
  - "仿生免疫"
# heroImage: "../assets/your-hero.png"
---

《Immuno-mimetic Deep Neural Networks (Immuno-Net)》提出了一种名为Immuno-Net的新型生物仿生计算框架，旨在通过模拟哺乳动物适应性免疫系统中的B细胞亲和力成熟机制，构建能够有效防御对抗性攻击的鲁棒性深度神经网络。

## 问题形式化与设计动机

深度神经网络（DNN）虽然在各类任务中表现优异，但面对对抗性攻击（adversarial attacks）或数据分布漂移（covariate shifts）时往往表现出脆弱性。相比之下，生物界的适应性免疫系统具有高度的鲁棒性，能够通过识别“自我”与“非我”成分，并针对细菌、病毒等各类病原体攻击产生特异性的防御反应。

该研究将生物免疫系统的防御机制映射到计算领域，旨在解决DNN的对抗鲁棒性问题。在此框架下，对抗性样本被视为入侵的抗原（Antigen），而用于防御的训练数据点被视为B细胞（B-cells）。研究的核心动机在于利用免疫系统中的“亲和力成熟”（Affinity Maturation）过程——即通过变异、选择和克隆扩增来进化出对抗原具有高亲和力的抗体——来动态生成针对特定输入样本的最优防御策略。

## 算法设计原理与框架

为了实现上述生物机制的计算化，文章提出了“免疫网络鲁棒自适应免疫启发式学习系统”（Immuno-Net RAILS）。该系统并非单纯改变网络权重，而是通过一个五阶段的演化过程来处理输入数据。

RAILS系统将免疫响应过程抽象为以下五个计算步骤：
1.  **感知（Sensing）：** 检测输入是否为潜在威胁。
2.  **聚集（Flocking）：** 召集初始的防御候选群体。
3.  **扩增（Expansion）：** 扩大候选群体规模。
4.  **优化（Optimization）：** 通过变异和选择进化出更优的防御样本。
5.  **共识（Consensus）：** 基于进化出的高亲和力群体进行最终决策。

这种设计使得防御机制具有高度的适应性，能够在推理阶段针对特定的对抗扰动动态调整其内部表示。

## RAILS算法实现流程

RAILS算法的具体执行流程紧密遵循上述五个阶段，结合了特征空间中的距离度量与进化策略。

### 感知阶段
感知阶段旨在模拟免疫系统的“自我/非我”识别功能。系统首先对输入数据 $\mathbf{x}$ 进行威胁评分检测。这实际上是一个异常检测（Outlier Detection）过程，用于区分由于对抗性扰动产生的输入（非我）和干净的输入（自我）。这一步能有效防止系统对正常输入产生误报，仅在检测到威胁时触发后续的免疫反应。

### 聚集阶段
在确认威胁后，系统通过“聚集”机制寻找初始的防御群体。这对应于生物体中B细胞向淋巴结聚集的过程。在计算实现上，对于每一个类别 $c$ 和选定的网络层 $l$，算法在训练数据集 $\mathcal{D}_c$ 中寻找与输入 $\mathbf{x}$ 在特征空间亲和力最高的 $k$ 个最近邻（k-Nearest Neighbors）。

亲和力函数 $A(f_l; \mathbf{x}_1, \mathbf{x}_2)$ 定义为特征空间中负的欧几里得距离：
$$
A(f_l; \mathbf{x}_1, \mathbf{x}_2) = -\|f_l(\mathbf{x}_1) - f_l(\mathbf{x}_2)\|_2
$$
其中 $f_l(\cdot)$ 表示第 $l$ 层的特征映射。聚集过程生成的初始群体 $\mathcal{N}_l^c$ 包含了每个类别中与当前输入最相似的样本，确保了防御起点的多样性与平衡性。

### 亲和力成熟：扩增与优化
这是RAILS算法的核心部分，模拟了生发中心（Germinal Centers）内的克隆扩增与体细胞高频突变。该过程是一个多代进化的循环：

1.  **初始种群生成：** 将聚集阶段找到的最近邻样本作为父代，通过随机变异复制多次，形成第0代种群。
2.  **选择（Selection）：** 在每一代进化中，根据样本与输入 $\mathbf{x}$ 的亲和力计算选择概率。选择概率向量 $\mathbf{P}$ 通过Softmax函数获得：
    $$
    \mathbf{P}(\mathbf{x}_i) = \frac{\exp (A(f_l; \mathbf{x}_i, \mathbf{x})/\tau)}{\sum_{\mathbf{x}_j \in S} \exp (A(f_l; \mathbf{x}_j, \mathbf{x})/\tau)}
    $$
    其中 $\tau$ 是控制选择压力的温度参数。这意味着与输入（抗原）亲和力越高（距离越近）的样本，被选中繁衍后代的概率越大。
3.  **交叉与变异（Crossover and Mutation）：**
    *   **交叉：** 算法从当前种群中选择两个具有相同标签的父代样本，基于它们的亲和力得分，随机从父代中选取元素（像素）进行组合。
    *   **变异：** 对组合后的后代施加随机扰动。变异操作以概率 $\rho$ 向数据添加均匀分布的噪声，噪声范围在 $[-\delta_{\max}, -\delta_{\min}] \cup [\delta_{\min}, \delta_{\max}]$ 之间，并进行截断以满足数据域约束。

这一过程重复进行 $G$ 代，使得种群逐渐向特征空间中与对抗样本最接近的流形收敛。

### 共识阶段
经过多代进化后，系统根据亲和力得分筛选最终的群体：
*   **浆细胞数据（Plasma Data, $S_p$）：** 每一层中亲和力最高的前5%样本，代表了针对当前攻击的最优防御解。
*   **记忆数据（Memory Data, $S_m$）：** 亲和力排名前25%的样本，可用于未来防御类似攻击（模拟免疫记忆）。

最终的预测结果 $y$ 通过对所有选定层生成的浆细胞数据 $S_p$ 进行多数投票（Majority Voting）获得。由于浆细胞数据继承了其父代（原始训练数据）的标签，这种共识机制能够利用进化出的、与攻击样本分布高度一致的良性样本来推断正确的类别标签。

## 算法执行特性与分析

Immuno-Net RAILS 的执行展现了模拟生物进化的动态特性。其学习曲线（Learning Curve）反映了多样性与选择压力之间的权衡：在进化初期，种群多样性较高，亲和力较低；随着代数增加，选择机制使得种群向高亲和力区域收敛，亲和力得分单调上升。

该算法并不改变预训练模型的权重，而是作为一个推断时的动态防御过程。通过在特征空间中生成与对抗样本极度接近但仍保留原始类别语义的合成样本（即浆细胞数据），RAILS 能够有效地覆盖攻击样本所在的流形区域。实验结果表明，该方法在MNIST、SVHN和CIFAR-10数据集上，相较于基准方法（如DkNN）显著提高了对抗鲁棒精度（Robust Accuracy），同时保持了在干净数据上的标准精度。此外，生成的“记忆数据”为实现终身学习（Lifelong Learning）和应对未来相似攻击提供了机制基础。