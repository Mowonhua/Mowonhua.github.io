---
title: "自适应物联网入侵检测框架"
description: ""
pubDate: 2026-01-06 16:18
tags:
  - "仿生免疫"
  - "入侵检测"
  - "物联网"
# heroImage: "../assets/your-hero.png"
---

《An adaptive detection framework based on artificial immune for IoT intrusion detection system》提出了一种基于人工免疫系统的自适应物联网入侵检测框架（NaIM-IDS）。该研究旨在解决传统网络异常检测方法在面对物联网海量、高维数据及不断演变的攻击手段时，存在的检测率低、适应性差以及检测器生成效率低下等问题。通过引入改进的混合双模块高维特征选择算法、自样本模糊聚类机制以及自适应检测器生成策略，该框架实现了对异常流量的高效识别和动态适应。

## 概述

随着物联网设备数量和数据流量的指数级增长，传统入侵检测系统面临着严重的计算负担和“维度灾难”。此外，基于人工免疫系统（AIS）的否定选择算法（NSA）虽然具有良好的自适应性，但传统的随机检测器生成方式容易导致检测漏洞（Holes）和冗余，且对高维数据的处理能力不足。NaIM-IDS 框架通过三个核心层面的创新来应对这些挑战：首先，利用改进的进化算法进行高维特征选择，剔除冗余特征；其次，利用模糊聚类优化自体（Self）空间的表示，减少检测器生成的计算开销；最后，提出一种分区域的自适应检测器生成机制，分别针对边界区域和非边界区域采用不同的优化策略，从而提高检测覆盖率并降低误报率。

## 总体架构设计

NaIM-IDS 框架主要由三个相互关联的模块组成，形成了一个完整的异常检测流水线：

1.  **数据预处理模块**：负责对原始网络流量数据进行清洗、数值化编码和归一化处理，为后续处理提供标准化的输入。
2.  **双模块混合特征选择模块**：这是框架的前端核心。该模块采用了一种改进的混合元启发式算法，结合了红狐优化（RFO）和哈里斯鹰优化（HHO）的优势。通过引入多种条件控制机制（如混沌映射初始化、自适应权重因子、精英差分进化策略等），在全局搜索和局部开发之间取得平衡，从高维数据中筛选出最具代表性的特征子集。
3.  **自适应检测器生成与检测模块**：这是框架的后端核心。
    *   **公差阶段（Tolerance Stage）**：引入基于模糊C均值（FCM）的自样本聚类算法。通过将相似的自体样本聚类，用簇中心代替个体进行距离计算，显著降低了检测器生成过程中的计算冗余。
    *   **检测器生成阶段**：将非自体（Non-self）空间划分为边界区域和非边界区域。针对边界区域，利用RFO算法优化检测器的位置和半径；针对非边界区域，基于非自体差异度划分种群并结合遗传算法进行进化。
    *   **检测阶段**：利用生成的优化检测器集合对测试数据进行分类，识别异常行为。

## 子组件原理

### 改进的双模块特征选择机制

为了解决高维特征选择中的早熟收敛和局部最优问题，该框架设计了基于RFO和HHO的混合优化算法。

**1. 种群初始化与自适应权重**
算法利用Tent混沌映射生成初始种群，以提高初始解在搜索空间中的遍历均匀性。Tent映射的迭代公式定义为：
$$
x(n+1) = \begin{cases} x(n)/\alpha & , x(n) \in [0, \alpha) \\ (1-x(n)/\alpha)/(1-\alpha) & , x(n) \in [\alpha, 1] \end{cases}
$$
其中，$x(n+1)$ 是生成的混沌序列值，$\alpha$ 为参数（$\alpha \neq 0.5$）。
同时，为了平衡全局探索与局部开发，引入了基于正弦函数的自适应惯性权重 $\omega$。权重计算公式如下：
$$
\omega = \begin{cases} \omega_{min} + (\omega_{max} - \omega_{min}) \sin \left( \pi * \frac{f - f_{min}}{f_{avg} - f_{min}} \right) & , f \le f_{avg} \\ \omega_{max} & , f > f_{avg} \end{cases}
$$
其中，$\omega_{max}$ 和 $\omega_{min}$ 分别为权重的最大值和最小值，$f$ 为当前个体的适应度，$f_{avg}$ 为平均适应度。当个体适应度优于平均值时，较小的权重促进局部搜索；反之，较大的权重促进全局搜索。

计算得到的自适应权重 $\omega$ 随后被直接应用于个体的更新公式中，用于修正个体的位置或速度向量：
$$
((\bar{x})^t)' = ((\bar{x})^t)' + \omega \times \text{sgn} \left( (\bar{x}_{best})^t - ((\bar{x})^t)' \right)
$$
其中，$((\bar{x})^t)'$表示更新前的个体状态。$(\bar{x}_{best})^t$表示当前迭代中的最优个体位置。$\text{sgn}(\cdot)$是符号函数，决定了移动的方向。$\omega$ 作为系数，直接决定了当前个体向最优个体 $(\bar{x}_{best})^t$ 靠拢的幅度。 具体来说：
*   当 $\omega$ 较大时，个体以较大的步长向最优解移动，探索新的区域。
*   当 $\omega$ 较小时，个体的移动步长缩短，仅在当前位置与最优解之间进行微调。

通过这种将个体适应度与正弦函数相结合的动态权重调整策略，算法能够在进化的不同阶段智能地切换搜索模式，从而显著提高了在高维特征空间中寻找最优特征子集的效率和精度。

**2. 二进制转换与适应度评估**
特征选择属于离散组合优化问题。算法使用双曲正割函数作为传递函数，将连续的优化空间映射到二进制空间：
$$
T(x_i^j(t)) = \frac{2}{e^{-(x_i^j(t))} + e^{(x_i^j(t))}}
$$
$$
x_i^j(t+1) = \begin{cases} 1, & \text{rand} > T(x_i^j(t)) \\ 0, & \text{Otherwise} \end{cases}
$$
其中，$x_i^j(t)$ 是第 $t$ 次迭代中第 $i$ 个解的第 $j$ 维数值。值为1表示选择该特征，0表示舍弃。
适应度函数 $f$ 综合考虑了分类错误率和特征数量：
$$
f(x_i(t)) = \gamma E_{x_i(t)} + (1-\gamma) \left( \frac{|x_i(t)|}{|S|} \right)
$$
其中，$E_{x_i(t)}$ 是分类器（如KNN）的错误率，$|x_i(t)|$ 是被选特征数，$|S|$ 是总特征数，$\gamma$ 是平衡因子。

**3. 双模块混合与精英差分进化**
算法根据适应度概率 $P_f$ 动态选择更新策略。若 $P_f > 0.5$，采用RFO更新机制；否则采用HHO更新机制。
$$
P_i = \frac{\sqrt{f_{best} - f_{worst}} \times f_i}{\sum_{i=1}^{N} f_i}
$$
为了增强算法跳出局部最优的能力，引入了基于精英个体的差分进化（DE）策略。
在进化早期，采用具有强全局搜索能力的变异策略：
$$
v_i = x_{r1} + F \times (x_{r2} - x_{r3}) + F \times (x_{r4} - x_{r5})
$$
在进化晚期，利用精英个体引导局部搜索：
$$
v_i = x_i + F \times (Elite_x - x_{r1}) + F \times (x_{r2} - x_{r3})
$$
其中，$x_{r1}$ 至 $x_{r5}$ 是随机选择的个体，$Elite_x$ 是种群中适应度最好的前10%个体，$F$ 是缩放因子。

**4. 停滞检测与反向学习**
算法通过监测种群平均适应度的变化率 $ST$ 来判断是否停滞。当检测到停滞时（即 $ST$ 低于阈值 $SP\%$），利用随机反向学习策略生成新解：
$$
(\bar{x}_j)^r = lb + ub - rand() \times \bar{x}_{best}^j
$$
其中 $\bar{x}_{best}^j$ 是当前最优解位置，该机制有助于算法在停滞时探索新的搜索区域。

### 自样本模糊聚类与自适应检测器生成

**1. 自样本模糊聚类（FCM）**
为了减少检测器生成过程中与海量自体样本的距离计算次数，框架采用模糊C均值算法对自体样本进行聚类。FCM 旨在最小化目标函数 $J_m$：
$$
J_m = \sum_{i=1}^{n} \sum_{j=1}^{c} u_{ij}^m \|x_i - v_j\|^2
$$
其中 $n$ 为样本数，$c$ 为聚类数，$u_{ij}$ 为样本 $x_i$ 对簇中心 $v_j$ 的隶属度，$m$ 为模糊系数。隶属度 $u_{ij}$ 更新公式为：
$$
u_{ij} = \frac{1}{\sum_{k=1}^{c} \left( \frac{\|x_i - v_j\|}{\|x_i - v_k\|} \right)^{\frac{2}{m-1}}}
$$
簇中心 $v_j$ 更新公式为：
$$
v_j = \frac{\sum_{i=1}^{n} u_{ij}^m x_i}{\sum_{i=1}^{n} u_{ij}^m}
$$
算法迭代直至满足终止条件 $|J_{m+1} - J_m| < \epsilon$。为了确定最佳聚类数，引入了综合类内紧密度 $com$ 和类间分离度 $sep = \|c_1 - c_2\|$ 的评估指标。

**2. 边界检测器生成（基于 RFO）**
在自体与非自体的边界区域，检测器生成难度大且容易产生漏洞。该框架利用 RFO 算法优化检测器的位置和半径。通过最大化检测器的覆盖率并最小化与自体的重叠，生成最优边界检测器集合 $D_{boundary}$。

**3. 非边界检测器生成（基于非自体差异）**
对于远离边界的非自体区域，框架采用基于差异度的子种群进化策略。首先计算非自体样本 $p_i$ 与现有类别 $C_j$ 的差异度 $Diff$：
$$
Diff = (p_i, C \mid D_j) = |p_i - c_j|
$$
基于差异度将非自体划分为不同的子种群，并在每个子种群内部独立执行选择、交叉和变异等进化操作，从而生成能有效覆盖非边界区域的检测器集合。

## 架构的实现与执行

NaIM-IDS 的具体实现流程体现了从特征工程到模型构建的系统化整合：

1.  **特征空间构建**：首先通过 Tent 混沌映射初始化特征选择算法的种群。在迭代过程中，计算每个个体的适应度，并根据适应度概率自适应地切换 RFO 和 HHO 更新策略。同时，结合停滞检测机制，在算法陷入局部最优时触发随机反向学习。最终输出的最优特征子集用于重构训练和测试数据。
2.  **自体空间压缩**：利用选定特征对数据进行降维后，执行自样本模糊聚类。算法迭代更新隶属度矩阵和簇中心，直到满足收敛条件（如簇中心变化小于阈值 $\epsilon$）。生成的簇中心及其半径构成了压缩后的自体空间表示，用于后续的耐受性检查。
3.  **双策略检测器生成**：
    *   在边界区域，初始化随机检测器种群，利用 RFO 算法进行寻优，剔除识别自体的检测器，保留覆盖率高且不与自体重叠的检测器。
    *   在非边界区域，基于非自体样本的差异度将其分配至不同子种群，通过遗传算法并行进化各子种群中的检测器。
4.  **异常检测执行**：将边界检测器和非边界检测器合并，形成最终的检测器库。对于新到来的网络流量数据，计算其与检测器库中元素的距离。若数据落入任意检测器的覆盖范围内，则判定为异常或攻击行为；否则判定为正常流量。

该架构通过这种分阶段、分区域的混合策略，有效地解决了传统方法在高维复杂网络环境下的适应性难题。